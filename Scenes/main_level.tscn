[gd_scene load_steps=17 format=3 uid="uid://cnlqiy1t1tlfa"]

[ext_resource type="Script" uid="uid://uxtklgw6afd8" path="res://Scripts/camera_collider.gd" id="1_a2ia3"]
[ext_resource type="Material" uid="uid://6hyaudq2jro0" path="res://Assets/Materials/M_Window.tres" id="1_q2fht"]
[ext_resource type="Material" uid="uid://3alykgpghls1" path="res://Assets/Materials/M_Door.tres" id="2_ikcpc"]
[ext_resource type="Script" uid="uid://b1kqadvicdqaf" path="res://Scripts/swinging.gd" id="3_5erdv"]
[ext_resource type="PackedScene" uid="uid://8q5t0t2rflcq" path="res://Scenes/playfabs/cop.tscn" id="4_qbrl8"]
[ext_resource type="Shader" uid="uid://d2xcewttt2h0r" path="res://Assets/Materials/Shaders/crt-effect.gdshader" id="6_236hc"]
[ext_resource type="Script" uid="uid://c0emh3p8iwj30" path="res://Scripts/moving_trigger.gd" id="6_tqiex"]
[ext_resource type="Texture2D" uid="uid://bmgi4b7e8bjta" path="res://Assets/Textures/noise.png" id="7_lwkuy"]

[sub_resource type="BoxShape3D" id="BoxShape3D_5erdv"]
size = Vector3(4.75, 3, 4.617)

[sub_resource type="BoxShape3D" id="BoxShape3D_qbrl8"]
size = Vector3(9.37, 3, 4.617)

[sub_resource type="Sky" id="Sky_tv1p5"]

[sub_resource type="Environment" id="Environment_q2fht"]
background_mode = 1
sky = SubResource("Sky_tv1p5")
ambient_light_source = 1
ssr_enabled = true
ssao_enabled = true
sdfgi_enabled = true
sdfgi_use_occlusion = true
glow_enabled = true

[sub_resource type="NavigationMesh" id="NavigationMesh_5erdv"]
vertices = PackedVector3Array(-4.5, 0.636905, -4.5, -4.5, 0.636905, 4.5, 4.5, 0.636905, 4.5, 4.5, 0.636905, -4.5)
polygons = [PackedInt32Array(3, 2, 0), PackedInt32Array(0, 2, 1)]

[sub_resource type="PlaneMesh" id="PlaneMesh_5erdv"]
size = Vector2(10, 10)

[sub_resource type="BoxShape3D" id="BoxShape3D_tqiex"]
size = Vector3(3.83359, 2.25256, 3.35216)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_lwkuy"]
shader = ExtResource("6_236hc")
shader_parameter/noise_texture = ExtResource("7_lwkuy")

[node name="MainLevel" type="Node3D"]

[node name="CameraSystem" type="Node3D" parent="."]

[node name="CAM1" type="Node3D" parent="CameraSystem"]

[node name="TriggerArea" type="Area3D" parent="CameraSystem/CAM1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.98022, 0, -2.73704)
collision_layer = 0
collision_mask = 2
script = ExtResource("1_a2ia3")

[node name="CollisionShape3D" type="CollisionShape3D" parent="CameraSystem/CAM1/TriggerArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.42819, 1.14895, 0.260505)
shape = SubResource("BoxShape3D_5erdv")

[node name="WorkCamera" type="Camera3D" parent="CameraSystem/CAM1/TriggerArea"]
transform = Transform3D(-0.767277, -0.495502, 0.407141, 1.49012e-08, 0.634852, 0.772634, -0.641316, 0.592824, -0.487107, 2.46252, 3.37822, -1.75529)
fov = 65.4

[node name="CAM2" type="Node3D" parent="CameraSystem"]

[node name="TriggerArea" type="Area3D" parent="CameraSystem/CAM2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.14262, 0, -2.80726)
collision_layer = 0
collision_mask = 2
script = ExtResource("1_a2ia3")

[node name="CollisionShape3D" type="CollisionShape3D" parent="CameraSystem/CAM2/TriggerArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.797435, 1.14895, 0.311523)
shape = SubResource("BoxShape3D_5erdv")

[node name="WorkCamera" type="Camera3D" parent="CameraSystem/CAM2/TriggerArea"]
transform = Transform3D(-0.681896, 0.515413, -0.519006, 0, 0.709558, 0.704647, 0.731449, 0.480496, -0.483845, -0.958215, 3.75841, -1.29712)
fov = 65.0

[node name="CAM3" type="Node3D" parent="CameraSystem"]

[node name="TriggerArea" type="Area3D" parent="CameraSystem/CAM3"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.81188, 0, 2.11499)
collision_layer = 0
collision_mask = 2
script = ExtResource("1_a2ia3")

[node name="CollisionShape3D" type="CollisionShape3D" parent="CameraSystem/CAM3/TriggerArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.797435, 1.14895, 0.311523)
shape = SubResource("BoxShape3D_qbrl8")

[node name="WorkCamera" type="Camera3D" parent="CameraSystem/CAM3/TriggerArea"]
transform = Transform3D(0.518833, 0.548131, -0.656022, 5.24445e-08, 0.767389, 0.641182, 0.854876, -0.332666, 0.398147, -3.83238, 3.23789, 2.34321)
fov = 65.0

[node name="Lighting" type="Node3D" parent="."]

[node name="WorldEnvironment" type="WorldEnvironment" parent="Lighting"]
environment = SubResource("Environment_q2fht")

[node name="Reflection" type="Node3D" parent="Lighting"]

[node name="ReflectionProbe" type="ReflectionProbe" parent="Lighting/Reflection"]
transform = Transform3D(1, 0, 0, 0, -0.0126883, 0.99992, 0, -0.99992, -0.0126883, 1.64422, 2.68196, -2.49291)

[node name="GI" type="Node3D" parent="Lighting"]

[node name="Lights" type="Node3D" parent="Lighting"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.44054, -1.41145, -0.342801)

[node name="RoomSpot" type="SpotLight3D" parent="Lighting/Lights"]
transform = Transform3D(1, 0, 0, 0, -0.0126883, 0.99992, 0, -0.99992, -0.0126883, 0.77087, 4.57577, -2.31704)
light_color = Color(0.968627, 0.913725, 0.592157, 1)
shadow_enabled = true
distance_fade_enabled = true
distance_fade_begin = 0.0
distance_fade_shadow = 0.0
distance_fade_length = 15.0
spot_range = 5.025
spot_attenuation = 0.04
spot_angle = 80.91
spot_angle_attenuation = 3.249
script = ExtResource("3_5erdv")
swing_speed = 0.07
pos_offset = Vector3(0.18, 0, 0)
rot_offset = Vector3(0.1, 0, 7)

[node name="RoomSpot2" type="SpotLight3D" parent="Lighting/Lights"]
transform = Transform3D(1, 0, 0, 0, -0.0126883, 0.99992, 0, -0.99992, -0.0126883, -3.70381, 4.57029, -2.31704)
light_color = Color(0.968627, 0.913725, 0.592157, 1)
shadow_enabled = true
distance_fade_enabled = true
distance_fade_begin = 0.0
distance_fade_shadow = 0.0
distance_fade_length = 15.0
spot_range = 5.025
spot_attenuation = 0.04
spot_angle = 80.91
spot_angle_attenuation = 3.249
script = ExtResource("3_5erdv")
swing_speed = 0.08
pos_offset = Vector3(0.2, 0, 0)
rot_offset = Vector3(0.1, 0, 8)

[node name="RoomSpot4" type="SpotLight3D" parent="Lighting/Lights"]
transform = Transform3D(1, 0, 0, 0, -0.0126883, 0.99992, 0, -0.99992, -0.0126883, -1.40421, 4.24644, 2.75159)
light_color = Color(0.968627, 0.913725, 0.592157, 1)
shadow_enabled = true
distance_fade_enabled = true
distance_fade_begin = 0.0
distance_fade_shadow = 0.0
distance_fade_length = 15.0
spot_range = 9.471
spot_attenuation = 0.42
spot_angle = 86.05
spot_angle_attenuation = 2.46228
script = ExtResource("3_5erdv")
swing_speed = 0.1
pos_offset = Vector3(0.45, 0, 0)

[node name="RoomSpot3" type="SpotLight3D" parent="Lighting/Lights"]
transform = Transform3D(1, 0, 0, 0, -0.0126883, 0.99992, 0, -0.99992, -0.0126883, 3.28756, 4.68365, -2.31704)
visible = false
light_color = Color(0.968627, 0.913725, 0.592157, 1)
shadow_enabled = true
distance_fade_enabled = true
distance_fade_begin = 0.0
distance_fade_shadow = 0.0
distance_fade_length = 15.0
spot_range = 5.025
spot_attenuation = 0.04
spot_angle = 80.91
spot_angle_attenuation = 3.249

[node name="Navigation" type="Node3D" parent="."]

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="Navigation"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.463233, 0)
navigation_mesh = SubResource("NavigationMesh_5erdv")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Navigation/NavigationRegion3D"]
mesh = SubResource("PlaneMesh_5erdv")

[node name="Cop" parent="." instance=ExtResource("4_qbrl8")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.69482, 0.137719, -3.67262)

[node name="Level" type="Node3D" parent="."]

[node name="Floor" type="CSGCombiner3D" parent="Level"]
use_collision = true

[node name="CSGBox3D" type="CSGBox3D" parent="Level/Floor"]
size = Vector3(10, 0.25, 10)

[node name="InteriorWall" type="CSGCombiner3D" parent="Level"]
operation = 2
use_collision = true

[node name="Wall" type="CSGBox3D" parent="Level/InteriorWall"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65778, 0)
size = Vector3(10, 3.31555, 0.25)

[node name="Door" type="CSGBox3D" parent="Level/InteriorWall"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.94346, 1.08273, 0)
operation = 2
size = Vector3(2, 2, 1)

[node name="WindowHole" type="CSGBox3D" parent="Level/InteriorWall"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.65192, 1.27406, 0)
operation = 2
size = Vector3(5.02492, 1.31369, 1)

[node name="Window" type="CSGBox3D" parent="Level/InteriorWall"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.65192, 1.27406, 0)
size = Vector3(5.025, 1.314, 0.05)
material = ExtResource("1_q2fht")

[node name="Doors" type="CSGCombiner3D" parent="Level"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.65192, 1.27406, 0)

[node name="Door" type="CSGBox3D" parent="Level/Doors"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -5.09844, -0.17195, 0)
size = Vector3(0.981216, 1.91936, 0.065)
material = ExtResource("2_ikcpc")
script = ExtResource("6_tqiex")
offset = Vector3(-1, 0, 0)

[node name="Door2" type="CSGBox3D" parent="Level/Doors"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.08813, -0.173335, 0)
size = Vector3(0.975723, 1.91659, 0.065)
material = ExtResource("2_ikcpc")
script = ExtResource("6_tqiex")
offset = Vector3(1, 0, 0)

[node name="Area3D" type="Area3D" parent="Level/Doors"]
collision_layer = 0
collision_mask = 2

[node name="CollisionShape3D" type="CollisionShape3D" parent="Level/Doors/Area3D"]
transform = Transform3D(0.999691, 0, 0.0248684, 0, 1, 0, -0.0248684, 0, 0.999691, -4.43982, -0.0158081, 0.00105505)
shape = SubResource("BoxShape3D_tqiex")

[node name="ExteriorWalls" type="CSGCombiner3D" parent="Level"]
use_collision = true

[node name="CSGBox3D" type="CSGBox3D" parent="Level/ExteriorWalls"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.72647, 4.86735)
size = Vector3(10, 3.46924, 0.25)

[node name="CSGBox3D2" type="CSGBox3D" parent="Level/ExteriorWalls"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.64609, -4.87601)
size = Vector3(10, 3.30847, 0.25)

[node name="CSGBox3D3" type="CSGBox3D" parent="Level/ExteriorWalls"]
transform = Transform3D(-0.000139638, 0, -1, 0, 1, 0, 1, 0, -0.000139638, -4.87168, 1.65396, -0.00500924)
size = Vector3(10, 3.32422, 0.25)

[node name="CSGBox3D4" type="CSGBox3D" parent="Level/ExteriorWalls"]
transform = Transform3D(-0.000139638, 0, -1, 0, 1, 0, 1, 0, -0.000139638, 4.87168, 1.64688, -0.0036487)
size = Vector3(10, 3.31006, 0.25)

[node name="Post-Processing" type="Node" parent="."]

[node name="CanvasLayer" type="CanvasLayer" parent="Post-Processing"]

[node name="ColorRect" type="ColorRect" parent="Post-Processing/CanvasLayer"]
material = SubResource("ShaderMaterial_lwkuy")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[connection signal="body_entered" from="CameraSystem/CAM1/TriggerArea" to="CameraSystem/CAM1/TriggerArea" method="_on_body_entered"]
[connection signal="body_exited" from="CameraSystem/CAM1/TriggerArea" to="CameraSystem/CAM1/TriggerArea" method="_on_body_exited"]
[connection signal="body_entered" from="CameraSystem/CAM2/TriggerArea" to="CameraSystem/CAM2/TriggerArea" method="_on_body_entered"]
[connection signal="body_exited" from="CameraSystem/CAM2/TriggerArea" to="CameraSystem/CAM2/TriggerArea" method="_on_body_exited"]
[connection signal="body_entered" from="CameraSystem/CAM3/TriggerArea" to="CameraSystem/CAM3/TriggerArea" method="_on_body_entered"]
[connection signal="body_exited" from="CameraSystem/CAM3/TriggerArea" to="CameraSystem/CAM3/TriggerArea" method="_on_body_exited"]
[connection signal="body_entered" from="Level/Doors/Area3D" to="Level/Doors/Door" method="on_collision_entered"]
[connection signal="body_entered" from="Level/Doors/Area3D" to="Level/Doors/Door2" method="on_collision_entered"]
[connection signal="body_exited" from="Level/Doors/Area3D" to="Level/Doors/Door" method="on_collision_exited"]
[connection signal="body_exited" from="Level/Doors/Area3D" to="Level/Doors/Door2" method="on_collision_exited"]
